<link rel="import" href="../../bower_components/polymer/polymer.html">
<script src="https://cdn.steemjs.com/lib/latest/steem.min.js"></script>

<dom-module id="steem-blog">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
    <div id="blog"></div>
  </template>

  <script>
    Polymer({

      is: 'steem-blog',

      ready: function() {
        // https://stackoverflow.com/a/11128791/4333241
        function createBlog(array) {
          // Create the list element:
          var list = document.createElement('ul');

          for (var i = 0; i < array.length; i++) {
            // Create the list item:
            var item = document.createElement('li');

            // Set its contents:
            item.appendChild(document.createTextNode(array[i]['title']));

            // Add it to the list:
            list.appendChild(item);
          }

          // Finally, return the constructed list:
          return list;
        }
        // hardcode author (this is just for testing)
        var author = 'thekyle'
        // form JSON query
        var query = {
          'tag': author,
          'limit': 10
        }
        // Get the posts on a specific users blog
        var shadowRoot = this.root
        steem.api.getDiscussionsByBlog(query, function(err, result) {
          console.log(err, result);
          // Add the contents of result to #blog:
          shadowRoot.getElementById('blog').appendChild(createBlog(result));
        });
      },

      properties: {
        prop1: {
          type: String,
          value: 'steem-blog',
        },
      },

    });
  </script>
</dom-module>
